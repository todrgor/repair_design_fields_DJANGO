{% extends 'mainapp/base.html' %}

{% block title %}
  Смотреть лайфхаки: ремонт и дизайн
{% endblock %}

{% block css %}
  <link rel="stylesheet" href="/static/lib\css\style_hello_user.css">
  <link rel="stylesheet" href="/static/lib\css\style_header.css">
  <link rel="stylesheet" href="/static/lib\css\style_footer.css">
  <link rel="stylesheet" href="/static/lib\css\style_watch_designs.css">
  <link rel="stylesheet" href="/static/lib\css\style_watch_lifehacks.css">
  <link rel="stylesheet" href="/static/lib\css\style_filter.css">
{% endblock %}

{% block content %}
  <div class="page_title">
        <p class="title_p">Лайфхаки:</p>
        <p class="count_pubs">{{ pubs.count }} публикации</p>
  </div>


  <div class="pubs_container">
    {% for p in pubs %}

    <div class="pub_one lifehack" id="{{ p.id }}">
      <div class="media">
        {% if '.mp4' in p.preview.url or '.mov' in p.preview.url %}
        <video class="paused" muted="muted" controls="controls" loop>
          <source src="{{ p.preview.url }}" type='video/mp4;'>
          Тег video не поддерживается вашим браузером. Увы.
        </video>
        {% else %}
          <img src="{{ p.preview.url }}" alt="">
        {% endif %}
        <div class="img_black_gradient"> </div>
      </div>

      <div class="pub_info">
        <div class="pub_to_do">
          {% if p.id in saved_pubs %}
            <div class="user_just_saved_it pub_saved">
          {% else %}
            <div class="user_just_saved_it">
          {% endif %}
              <a onclick="
              {% if user.is_authenticated %}
                toggleSavePub_LH( {{ p.id }} )
              {% else %}
                YouHaveToLogin('сохранить публикацию')
              {% endif %}
              " title="Сохранить в «Избранное»"><img src="/static/sources/SVG/heart.svg" alt=""></a>
            </div>
          <div class="pub_author_cntnr">
            <div class="pub_author">
              <a href="{% url 'auth:account_one' pk=p.author.id %}"><img src="{{ p.author.photo.url }}" alt=""></a>
              <div class="nickname_and_role">
                <div class="nickname">
                  <a href="{% url 'auth:account_one' pk=p.author.id %}" class="nickname_link">{{ p.author.username }}</a>

                    {% if user.is_authenticated %}
                      <a onclick="toggleGetNotiFromAuthor( {{ p.author.id }} )" class="nickname_noti" id="{{ p.author.id }}">
                      {% if p.author.id in subscribing_authors %}
                        <div class="get_noti noties_gotten" title="Получать уведомления о новых записях пользователя {{ p.author.username }}"></div></a>
                      {% else %}
                        <div class="get_noti" title="Получать уведомления о новых записях пользователя {{ p.author.username }}"></div></a>
                      {% endif %}
                    {% else %}
                      <a onclick="YouHaveToLogin('получать уведомления о новых публикациях этого автора')" class="nickname_noti">
                      <div class="get_noti" title="Получать уведомления о новых записях пользователя {{ p.author.username }}"></div></a>
                    {% endif %}
                    <!-- <div class="get_noti_label">Получать уведомления о новых записях Алексея</div> -->
                </div>
                <p class="role">Автор публикации</p>
              </div>
            </div>
          </div>
            <a onclick="
              {% if user.is_authenticated %}
                togglePubAdditionalFunctions({{ p.id }})
              {% else %}
                YouHaveToLogin('подать жалобу или поделиться этой публикацией')
              {% endif %}
            "><div class="pub_show_full">•••</div></a>
        </div>
        <div class="div_pub_text">
          <p class="pub_text">{{ p.title }}</p>
        </div>
          <div class="pub_tags_container">
            {% for t in pub_has_tags %}
              {% if t.pub_id == p %}
                <form class="opened_filter_form" action="{% url 'pub:filter_lifehacks' %}" method="post">{% csrf_token %}
                  <label style='display:none;'> <span> <input type="checkbox" name="style_design" value="{{ t.tag_id.id }}" > </span><span>{{ t.tag_id.tag_category }}: {{ t.tag_id.tag_name }}</span> </label>
                  <div class="pub_tag">
                    <input style="cursor: pointer; margin: 0; background: none; border: none; font-size: 14px; color: #686868; font-family: 'Open Sans'; padding-right: 10px;"
                      type="submit" name="to_filter" value="{{ t.tag_id.tag_category }}: {{ t.tag_id.tag_name }}">
                    <img src="/static/sources/SVG/search.svg" alt="">
                  </div>
                </form>
              {% endif %}
            {% endfor%}
          </div>
      </div>
    </div>

    {% endfor %}
  </div>

  <div class="opened_filter_big_bg">
    <div class="pre_pre_opened_filter">
      <div class="pre__opened_filter">
        <div class="opened_filter">
          <form class="opened_filter_form" action="{% url 'pub:filter_lifehacks' %}" method="get">{% csrf_token %}
            <p class="opened_filter_title">Фильтры для публикаций</p>
            <div class="opened_filter_under_title">
              <p class="opened_filter_second_title">77 подобрано</p>
            </div>
            <div class="filter_mini_div bringed_pubs"> <!-- включённые фильтры -->
              <div class="filters_on"> <!-- если есть 1+ фильтров -->
                <div class="filter_one" id="fltr_style">
                   <p id="fltr_style_p">Фильтер сфера жизни</p>
                   <div class="to_close_filter fltr_style"></div>
                </div>
                <div class="filter_one" id="fltr_cost">
                   <p id="fltr_cost_p">Фильтер % просмотревших сохранили к себе</p>
                   <div class="to_close_filter fltr_cost"></div>
                </div>
                <input class="clear_filter" type="button" name="clear_filter" value="Очистить все фильтры">
              </div>
              <div class="filters_off"> <!-- если ни оного фильтра не включено -->
                <p>0 фильтров выбрано. <br> <span style="color: gray; font-size: 13px; font-family: 'Open Sans';">Показаны все публикации</span></p>
              </div>
            </div>
            <div class="filter_mini_div checked_styles">
              <p class="opened_filter_text full_width big_p">
                <span class="big_p_parth">
                  В сфере жизни:
                  <span id="checked_styles_count" class="checked_styles_count">В любой</span>
                </span>
                <span> <button type="button" name="button" class="triangle_to_open_and_hide open_hide_design_styles button_and_submit__without__bgn_and_border">
                  <img src="/static/sources/SVG/to_close_open_triangle.svg" alt="">
                </button> </span>
              </p>
              <div class="styles_labels_open">
                <div class="styles_any_one_label">
                  <label> <span> <input type="checkbox" name="style_design" value="3101001" > </span><span>Быт и уборка</span> </label>
                  <label class="any_one" style="max-width: 112px;"> <span> <input type="checkbox" name="style_design" value="any_one"> </span><span class="any_one__span">В любой сфере</span> </label>
                </div>
                <label> <span> <input type="checkbox" name="style_design" value="3101002" > </span><span>Красота, дизайн и уют</span> </label>
                <label> <span> <input type="checkbox" name="style_design" value="3101003" > </span><span>Строительство и ремонт</span> </label>
                <label> <span> <input type="checkbox" name="style_design" value="3101004" > </span><span>Планирование дизайна или ремонта</span> </label>
                <label> <span> <input type="checkbox" name="style_design" value="3101005" > </span><span>Другое</span> </label>
              </div>
            </div>
            <div class="filter_mini_div cost">
              <p class="opened_filter_text full_width">Сколько просмотревших<br>сохранили к себе, %</p>
              <input id="fltr_cost_min" type="number" min="0" max="100" name="cost_mini" value="" placeholder="0">
              <p style="font-size: 15px; font-weight: 900;">-</p>
              <input id="fltr_cost_max" type="number" min="0" max="100" name="cost_max" value="" placeholder="100">
              <!-- <input type="range" min="0" max="100" step="1" value="50"> -->
            </div>
            <!-- <div class="filter_mini_div user_feedbacks"> <p class="opened_filter_text">СОРТИРОВАТЬ, НАПРИМЕР По активности пользователей:</p> </div> -->
            <!-- <div class="filter_mini_div filter_other"> <p class="opened_filter_text">Дополнительно:</p> </div> -->
            <div class="show_pubs">
              <div class="show_pubs_container">
                <input class="filter_mini_div filter_to_filter" style="margin: 0;" type="submit" name="to_filter" value="Показать подобранные">
                <!-- <input class="filter_mini_div filter_to_filter" type="button" name="to_filter" value="Без фильтров"> -->
              </div>
            </div>
          <!-- <div class="clear_hix_show_pubs"></div> -->
          </form>
        </div>
      </div>

      <!-- <div class="close_btn"></div> -->
    </div>
  </div>

	<div class="filter_and_gradient">
		<div class="filter_and_gradient_container">
		  <button class="filter_button button_and_submit__without__bgn_and_border">
			<div class="filter">
			  <div class="filter_btn">
				<img class="filter_logo dont_close_on_click" src="/static/sources/SVG/filter_logo.svg" alt="">
				<p class="filter_p dont_close_on_click">Отфильтровать</p>
			  </div>
			  <div class="filter_tags_count dont_close_on_click">
				<p id="tags_count" class="dont_close_on_click">6</p>
			  </div>
			</div>
		  </button>
		</div>
	  </div>

  <div class="pub_additional_functions_bg"> <!-- доп функции с публикацией -->
    <div class="pub_additional_functions dont_close_on_click">
      <p class="dont_close_on_click" onclick="openNewComplaintForm()">Подать жалобу</p>
      <p class="dont_close_on_click" onclick="searchPubsLikeThis()" title="найти публикации-лайфхаки с такими же тэгами, как и эта публикция">Искать похожее</p>
      <p class="dont_close_on_click" onclick="shareThePub()">Поделиться</p>
    </div>
  </div>
  <div class="new_complaint"> <!-- написать жалобу -->
    {% csrf_token %}
    <h1>Жалоба на публикацию</h1>
    <textarea name="" id="" cols="30" rows="10" title="Напишите, в чём суть жалобы" placeholder="Напишите, в чём суть жалобы. Мы рассмотрим Вашу жалобу и что-нибудь решим, обязательно уведомив о результате вас."></textarea>
    <p>Если у вас есть фотографии по теме:</p>
    <input type="file" name="appea_photos" id="appea_photos" multiple accept="image/*" title="Загрузите фотографии по теме, если такие есть">
    <input type="submit" value="Отправить жалобу" onclick="new_complaint_was_sent()">
    <!-- <form>
    </form> -->
  </div>
  <div class="share_the_pub"> <!-- скопировать ссылку на публикацию -->
    <h1>Ссылка на публикацию: </h1>
    <a href="http://127.0.0.1:8000/pub/Z" style="text-decoration: underline; margin: 30px 0 10px; display: block;">http://127.0.0.1:8000/pub/one/?</a>
  </div>

{% endblock %}

{% block scripts_individual %}
  <script src="/static/lib/js/animation-lifehacks.js"></script>
{% endblock %}
